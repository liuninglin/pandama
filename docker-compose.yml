version: "3.1"

services:
  postgres:
    image: postgres:9.6
    networks:
      - inner_pandama

  redis:
    image: redis:6.2
    networks:
      - inner_pandama

  mongodb:
    image: mongo:5.0.5
    networks:
      - inner_pandama

  neo4j:
    image: neo4j/neo4j-arm64-experimental:4.1.0-arm64
    networks:
      - inner_pandama

  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:7.14.2
    networks:
      - inner_pandama

  rabbitmq:
    image: rabbitmq:3-management-alpine
    networks:
      - inner_pandama

  celery_worker:
    image: pandama_celery_worker
    networks:
      - inner_pandama
    depends_on:
      - postgres
      - rabbitmq
      - redis
      - mongodb
      - neo4j
      - elasticsearch

  celery_beat:
    image: pandama_celery_beat
    networks:
      - inner_pandama
    depends_on:
      - celery_worker

  web:
    image: pandama_web
    networks:
      - inner_pandama
    depends_on:
      - celery_beat

networks:
  inner_pandama: 
    driver: bridge